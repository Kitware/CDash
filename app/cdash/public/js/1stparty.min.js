$(document).ready(function(){$("#indexTable").trigger("appendCache")});
function getSortedElements(parent){var positions=[];return $(parent).children().each(function(){var pos={};pos.id=$(this).attr("id"),pos.position=$(this).index()+1,positions.push(pos)}),positions}
$(document).ready(function(){$("#tabs a").tab();var url=document.location.toString();url.match("#/")&&$(".nav-tabs a[href=#"+url.split("#/")[1]+"]").tab("show"),$(".nav-tabs a").on("shown",function(e){angular.element(window).location.hash=e.target.hash}),$("#tabs a").click(function(e){e.preventDefault(),$(this).tab("show")})});
function makeLineChart(elementName,inputData,project,anchor,sort){jQuery(function(){var chart=$.jqplot(elementName,[inputData],{axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer,tickOptions:{formatString:"%b %#d"}}},highlighter:{show:!0,sizeAdjust:7.5},cursor:{show:!1}});$("#"+elementName).bind("jqplotDataClick",function(ev,seriesIndex,pointIndex,data){var d=new Date(data[0]),day=("0"+d.getDate()).slice(-2),month=("0"+(d.getMonth()+1)).slice(-2),year=d.getFullYear(),date=year+"-"+month+"-"+day,url="index.php?project="+project+"&date="+date;sort&&(url+="&sort="+sort),anchor&&(url+="##"+anchor),window.open(url,"_blank")});var highest_value=chart.axes.xaxis._dataBounds.max,lowest_value=chart.axes.xaxis._dataBounds.min;highest_value>lowest_value&&(chart.axes.xaxis.max=highest_value,chart.axes.xaxis.min=lowest_value,chart.replot())})}
function makeBulletChart(chartName,elementName,min,avg,max,current,previous,chartHeight){var chart;nv.addGraph(function(){chart=nv.models.bulletChart().options({margin:{top:33,right:10,bottom:5,left:5},height:chartHeight+33});var chartData={ranges:[min,avg,max],rangeLabels:["Low","Medium","Satisfactory"],measures:[current],markers:[previous]};return previous==current&&(chartData.markerLabels=["Current"]),d3.select(elementName).datum(chartData).call(chart),chart})}
var CDash=angular.module("CDash",["angular-clipboard","ngAnimate","ngFileUpload","ui.sortable","ui.bootstrap"]);
angular.module("CDash").constant("VERSION","1576173055903");
CDash.directive("autoComplete",function($parse){return function(scope,element,attrs){element.autocomplete({source:$parse(attrs.availableValues)(scope)})}});
CDash.directive("build",function(VERSION){return{templateUrl:"build/views/partials/build_"+VERSION+".html"}});
CDash.directive("buildgroup",function(VERSION){return{templateUrl:"build/views/partials/buildgroup_"+VERSION+".html"}});
CDash.directive("convertToNumber",function(){return{require:"ngModel",link:function(scope,element,attrs,ngModel){ngModel.$parsers.push(function(val){return parseInt(val,10)}),ngModel.$formatters.push(function(val){return""+val})}}});
CDash.directive("daterange",function(VERSION){return{restrict:"A",templateUrl:"build/views/partials/daterange_"+VERSION+".html",link:function(scope,element,attrs,ngModelCtrl){function getDate(element){var date;try{date=$.datepicker.parseDate(format,element.value)}catch(error){date=null}return date}var format="yy-mm-dd",begin=element.find("#begin").datepicker({constrainInput:!1,changeMonth:!0,dateFormat:format,defaultDate:scope.cdash.date}).on("change",function(){var date=getDate(this);date&&end.datepicker("option","minDate",date)}),end=element.find("#end").datepicker({constrainInput:!1,changeMonth:!0,dateFormat:format,defaultDate:scope.cdash.date}).on("change",function(){var date=getDate(this);date&&begin.datepicker("option","maxDate",date)})}}});
CDash.directive("onFinishRender",function($timeout){return{restrict:"A",link:function(scope,element,attr){scope.$last===!0&&scope.$evalAsync(attr.onFinishRender)}}});
var timelineController=function($http,$scope){$scope.loading=!0,query_parameters={project:$scope.$parent.cdash.projectname,filterdata:$scope.$parent.cdash.filterdata},$scope.$parent.cdash.hasOwnProperty("begin")&&$scope.$parent.cdash.hasOwnProperty("end")?(query_parameters.begin=$scope.$parent.cdash.begin,query_parameters.end=$scope.$parent.cdash.end):query_parameters.date=$scope.$parent.cdash.date,$scope.$parent.cdash.hasOwnProperty("buildgroup")&&($scope.buildgroup=$scope.$parent.cdash.buildgroup,query_parameters.buildgroup=$scope.buildgroup),$http({url:"api/v1/timeline.php",method:"GET",params:query_parameters}).then(function(s){$scope.timeline=s.data,$scope.error=!1,$scope.finishSetup()},function(e){$scope.error=e.data})["finally"](function(){$scope.loading=!1}),$scope.finishSetup=function(){if(void 0!==$scope.timeline&&0!==$scope.timeline.length){var nightly_start_times=Object.keys($scope.timeline.time_to_date);$scope.nightly_start_times=nightly_start_times.map(function(x){return Number(x)}),nv.addGraph(function(){function brushstart(){return $scope.start_brushing?(d3.select(".nvtooltip").style("display","none"),void($scope.start_brushing=!1)):void($scope.start_brushing=!0)}function brushend(){function find_closest_time(input_time,valid_times){for(var mid,lo=0,hi=valid_times.length-1;hi-lo>1;)mid=Math.floor((lo+hi)/2),valid_times[mid]<input_time?lo=mid:hi=mid;return input_time-valid_times[lo]<=valid_times[hi]-input_time?valid_times[lo]:valid_times[hi]}if(d3.event.sourceEvent){var extent=$scope.timeline.brush.extent(),new_extent=[];new_extent[0]=find_closest_time(extent[0],$scope.nightly_start_times),new_extent[1]=find_closest_time(extent[1],$scope.nightly_start_times),new_extent[0]<$scope.timeline.min&&(new_extent[0]=$scope.timeline.min),new_extent[1]>$scope.timeline.max&&(new_extent[1]=$scope.timeline.max);var min_changed=extent[0]!=new_extent[0],max_changed=extent[1]!=new_extent[1];new_extent[0]==new_extent[1]&&(min_changed?new_extent[0]=new_extent[1]-864e5:max_changed&&(new_extent[1]=new_extent[0]+864e5)),new_extent[0]==extent[0]&&new_extent[1]==extent[1]||d3.select(this).transition().duration($scope.timeline.brush.empty()?0:750).call($scope.timeline.brush.extent(new_extent)).call($scope.timeline.brush.event),$scope.computeSelectedDateRange(),d3.select(".nvtooltip").style("display","block")}}$scope.timechart=nv.models.stackedAreaChart().x(function(d){return d[0]}).y(function(d){return d[1]}).interpolate("step-after").margin({top:30,right:60,bottom:30,left:60}).rightAlignYAxis(!1).showControls(!1).showLegend(!0).showTotalInTooltip(!1).useInteractiveGuideline(!0),$scope.timeline.hasOwnProperty("colors")&&$scope.timechart.color($scope.timeline.colors),$scope.timechart.xAxis.showMaxMin(!1),$scope.timechart_selection=d3.select("#timechart svg").datum($scope.timeline.data),$scope.timechart_selection.call($scope.timechart),$scope.timechart_selection.select(".nv-axislabel").style("font-size","16").style("font-weight","bold"),$scope.timechart.update(),nv.utils.windowResize($scope.timechart.update);var bbox=d3.select(".nv-stackedAreaChart g rect").node().getBBox(),text_element=$scope.timechart_selection.append("text").attr("class","nvd3").text("2999-12-31").style("visibility","hidden"),label_width=text_element.node().getBBox().width;text_element.remove();var num_ticks=Math.floor(Math.round(bbox.width)/(2*Math.ceil(label_width))),nightly_start_times=$scope.nightly_start_times.slice(0);if(nightly_start_times.pop(),nightly_start_times.length>num_ticks)for(var tick_values=[nightly_start_times[0]],interval=nightly_start_times.length/num_ticks,i=1;i<num_ticks;i++)tick_values.push(nightly_start_times[Math.round(i*interval)]);else var tick_values=nightly_start_times;$scope.timechart.xAxis.showMaxMin(!1).tickValues(tick_values).tickFormat(function(d){return $scope.timeline.time_to_date[d]}),$scope.timechart.update(),$scope.timeline.brush=d3.svg.brush().x($scope.timechart.xScale()).extent([$scope.timeline.extentstart,$scope.timeline.extentend]).on("brushstart",brushstart).on("brushend",brushend),$scope.start_brushing=!0;var brush_element=$scope.timechart_selection.select(".nv-areaWrap").append("g").attr("class","brush").call($scope.timeline.brush).selectAll("rect").attr("height",bbox.height).attr("fill-opacity",".125").attr("stroke","#fff");return brush_element.select(".background").remove(),$scope.computeSelectedDateRange(),$scope.timechart})}},$scope.computeSelectedDateRange=function(){var extent=$scope.timeline.brush.extent(),timestamps=Object.keys($scope.timeline.time_to_date);timestamps.indexOf(String(extent[0]))===-1?$scope.$parent.cdash.begin_date=$scope.timeline.time_to_date[Number(timestamps[0])]:$scope.$parent.cdash.begin_date=$scope.timeline.time_to_date[extent[0]],idx=timestamps.indexOf(String(extent[1])),idx>0?$scope.$parent.cdash.end_date=$scope.timeline.time_to_date[timestamps[idx-1]]:$scope.$parent.cdash.end_date=$scope.timeline.time_to_date[Number(timestamps[timestamps.length-1])]},$scope.updateSelection=function(){if("function"==typeof $scope.$parent.updateSelection)return $scope.$parent.updateSelection();var uri="//"+location.host+location.pathname+"?project="+$scope.cdash.projectname_encoded;$scope.hasOwnProperty("buildgroup")&&(uri+="&buildgroup="+$scope.buildgroup),uri+=$scope.cdash.begin_date==$scope.cdash.end_date?"&date="+$scope.cdash.begin_date:"&begin="+$scope.cdash.begin_date+"&end="+$scope.cdash.end_date,window.location=uri}};CDash.directive("timeline",function(VERSION){return{restrict:"A",templateUrl:"build/views/partials/timeline_"+VERSION+".html",controller:timelineController}});
CDash.filter("showEmptySubProjectsLast",function(){return function(subprojects,sortField){if(angular.isArray(subprojects)){if(!sortField)return subprojects;if(angular.isArray(sortField)){if(sortField.length<1)return subprojects;sortField=sortField[0]}"-"==sortField.charAt(0)&&(sortField=sortField.substring(1));var empty=subprojects.filter(function(subproject){return 0==subproject.nconfigureerror&&0==subproject.nconfigurewarning&&0==subproject.nconfigurepass&&0==subproject.nbuilderror&&0==subproject.nbuildwarning&&0==subproject.nbuildpass&&0==subproject.ntestfail&&0==subproject.ntestnotrun&&0==subproject.ntestpass}),nonempty=subprojects.filter(function(subproject){return 0!=subproject.nconfigureerror||0!=subproject.nconfigurewarning||0!=subproject.nconfigurepass||0!=subproject.nbuilderror||0!=subproject.nbuildwarning||0!=subproject.nbuildpass||0!=subproject.ntestfail||0!=subproject.ntestnotrun||0!=subproject.ntestpass});switch(sortField){case"name":case"lastsubmission":default:return subprojects;case"nconfigureerror":case"nconfigurewarning":case"nconfigurepass":var present=nonempty.filter(function(subproject){return 0!=subproject.nconfigureerror||0!=subproject.nconfigurewarning||0!=subproject.nconfigurepass}),missing=nonempty.filter(function(subproject){return 0==subproject.nconfigureerror&&0==subproject.nconfigurewarning&&0==subproject.nconfigurepass});present=present.concat(missing);break;case"nbuilderror":case"nbuildwarning":case"nbuildpass":var present=nonempty.filter(function(subproject){return 0!=subproject.nbuilderror||0!=subproject.nbuildwarning||0!=subproject.nbuildpass}),missing=nonempty.filter(function(subproject){return 0==subproject.nbuilderror&&0==subproject.nbuildwarning&&0==subproject.nbuildpass});present=present.concat(missing);break;case"ntestfail":case"ntestnotrun":case"ntestpass":var present=nonempty.filter(function(subproject){return 0!=subproject.ntestfail||0!=subproject.ntestnotrun||0!=subproject.ntestpass}),missing=nonempty.filter(function(subproject){return 0==subproject.ntestfail&&0==subproject.ntestnotrun&&0==subproject.ntestpass});present=present.concat(missing)}return present.concat(empty)}}});
CDash.filter("ctestNonXmlCharEscape",function(){return function(input){var pattern=/\[NON-XML-CHAR-0x1B\]/g;return input.replace(pattern,"")}}).filter("terminalColors",function(){return function(input,htmlEscape){var ansiUp=new AnsiUp;return void 0!==htmlEscape&&(ansiUp.escape_for_html=htmlEscape),ansiUp.ansi_to_html(input)}}).filter("trustAsHtml",["$sce",function($sce){return function(input){return $sce.trustAsHtml(input)}}]);
CDash.service("anchors",function($anchorScroll,$location,$timeout){this.jumpToAnchor=function(elementId){$timeout(function(){$location.hash(elementId),$anchorScroll()})}});
CDash.factory("apiLoader",function($http,$rootScope,$window,renderTimer){var loadPageData=function(controllerScope,endpoint){controllerScope.loading=!0,$http({url:endpoint,method:"GET",params:$rootScope.queryString}).then(function(s){var cdash=s.data;cdash.filterdata&&1==cdash.filterdata.showfilters&&(controllerScope.showfilters=!0),renderTimer.initialRender(controllerScope,cdash),$rootScope.title=cdash.title,controllerScope.cdash.endpoint=endpoint+$window.location.search,"function"==typeof controllerScope.finishSetup&&controllerScope.finishSetup()},function(e){controllerScope.cdash=e.data})["finally"](function(){controllerScope.loading=!1})};return{loadPageData:loadPageData}});
function comparators(){return{getComparators:function(){return{array:[{pos:1,symbol:"in",text:"contains"},{pos:2,symbol:"not in",text:"does not contain"}],bool:[{pos:1,symbol:"==",text:"is"},{pos:2,symbol:"!=",text:"is not"}],number:[{pos:1,symbol:"<",text:"is less than"},{pos:2,symbol:">",text:"is greater than"},{pos:3,symbol:"==",text:"equals"}]}}}}angular.module("CDash").factory("comparators",comparators);
CDash.factory("filters",function(){var filters={};return filters.toggle=function(show){var str=new String(window.location),idx=str.indexOf("&showfilters=",0);idx>0&&(show?window.location.href=str.replace("&showfilters=0","&showfilters=1"):window.location.href=str.replace("&showfilters=1","&showfilters=0"))},filters.getString=function(){var str=new String(window.location),idx=str.indexOf("&filtercount=",0);return idx>0?str.substr(idx):""},filters.getLabelString=function(filterdata){if(void 0==filterdata)return"";for(var s="&showfilters=1",n=0,i=1;i<=filterdata.filters.length;i++){var field=filterdata.filters[i-1].field;"label"==field&&(n+=1,s=s+"&field"+i+"="+escape(field),s=s+"&compare"+i+"="+escape(filterdata.filters[i-1].compare),s=s+"&value"+i+"="+escape(filterdata.filters[i-1].value))}return n>1&&(s="&filtercombine="+filterdata.filtercombine+s),n>0?"&filtercount="+n+s:""},filters});
CDash.factory("modalSvc",function($uibModal){const showModal=function(modelId,okFn,template,parent_scope,size,success,error){return parent_scope="undefined"!=typeof parent_scope?parent_scope:null,size="undefined"!=typeof size?size:"sm",$modal=$uibModal.open({animation:!0,backdrop:!0,controller:function(){var $ctrl=this;$ctrl.ok=function(){okFn(modelId),$modal.close()},$ctrl.cancel=function(){$modal.close()}},controllerAs:"$ctrl",size:size,scope:parent_scope,templateUrl:template}),success=angular.isFunction(success)?success:function(){},error=angular.isFunction(error)?error:function(){},$modal.result.then(success,error),$modal};return{showModal:showModal}});
CDash.factory("multisort",function(){return{updateOrderByFields:function(obj,field,$event){var idx=obj.orderByFields.indexOf("-"+field);if($event.shiftKey)if(idx!=-1)obj.orderByFields[idx]=field;else{var idx2=obj.orderByFields.indexOf(field);idx2!=-1?obj.orderByFields[idx2]="-"+field:obj.orderByFields.push("-"+field)}else idx!=-1?obj.orderByFields=[field]:obj.orderByFields=["-"+field]}}});
CDash.factory("renderTimer",function($timeout){var initialRender=function(controllerScope,cdash){if("redirect"in cdash)return void(window.location=cdash.redirect);if(!(!1 in cdash)){var start=new Date;controllerScope.cdash=cdash,$timeout(function(){var renderTime=+((new Date-start)/1e3);controllerScope.cdash.generationtime=(renderTime+cdash.generationtime).toFixed(2)},0,!0,controllerScope,cdash)}};return{initialRender:initialRender}});
CDash.controller("BuildPropertiesController",function BuildPropertiesController($filter,$http,$scope,apiLoader,comparators,modalSvc,multisort){apiLoader.loadPageData($scope,"api/v1/buildProperties.php"),$scope.finishSetup=function(){if(!($scope.cdash.builds.length<1)){$scope.cdash.showDefects=!1,$scope.cdash.defectsLoaded=!1,$scope.cdash.selections=[],$scope.addSelection(),$scope.cdash.propertykeys=Object.keys($scope.cdash.properties),$scope.comparators=comparators.getComparators(),$scope.pagination=[],$scope.pagination.filteredTests=[],$scope.pagination.currentPage=1,$scope.pagination.maxSize=5;var num_per_page_cookie=$.cookie("buildProperties_num_per_page");num_per_page_cookie?$scope.pagination.numPerPage=parseInt(num_per_page_cookie):$scope.pagination.numPerPage=10;var sort_cookie_value=$.cookie("cdash_buildProperties_sort");sort_cookie_value?$scope.orderByFields=sort_cookie_value.split(","):$scope.orderByFields=["-builds.length"],$scope.chart_data=[],$scope.groups=[],$scope.addGroup("All",$scope.cdash.builds),$scope.computeChartData(),nv.addGraph(function(){return $scope.chart=nv.models.multiBarChart().duration(350).rotateLabels(0).showControls(!0).groupSpacing(.1),$scope.chart.xAxis.tickFormat(function(d){return void 0!==$scope.groups[d]?$scope.groups[d].keyword:""}),$scope.chart.yAxis.tickFormat(d3.format(",f")),$scope.chart.yAxis.axisLabel("Number of Builds"),$scope.chart_selection=d3.select("#chart svg").datum($scope.chart_data),$scope.chart_selection.call($scope.chart),$scope.chart.update(),nv.utils.windowResize($scope.chart.update),$scope.chart})}},$scope.addGroup=function(groupname,builds){var pos=$scope.groups.length,group={keyword:groupname,position:pos,builds:builds};$scope.groups.push(group)},$scope.computeChartData=function(){$scope.chart_data=[];for(var group_totals=[],i=0;i<$scope.groups.length;++i)group_totals.push({x:$scope.groups[i].position,y:$scope.groups[i].builds.length});for(var i=0;i<$scope.cdash.defecttypes.length;++i){var defect_type=$scope.cdash.defecttypes[i];if(defect_type.selected){for(var defect_values=[],j=0;j<$scope.groups.length;++j){for(var group=$scope.groups[j],defective_builds=0,k=0;k<group.builds.length;++k){var build=group.builds[k];defective_builds+=build[defect_type.name]>0?1:0}defect_values.push({x:group.position,y:defective_builds})}$scope.chart_data.push({key:defect_type.prettyname,values:defect_values})}}$scope.chart_data.push({key:"Total",values:group_totals})},$scope.updateSelection=function(){var uri="//"+location.host+location.pathname+"?project="+$scope.cdash.projectname_encoded;uri+=$scope.cdash.begin_date==$scope.cdash.end_date?"&date="+$scope.cdash.begin_date:"&begin="+$scope.cdash.begin_date+"&end="+$scope.cdash.end_date;for(var defect_types=[],i=0;i<$scope.cdash.defecttypes.length;++i){var defect_type=$scope.cdash.defecttypes[i];defect_type.selected&&defect_types.push(defect_type.name)}defect_types.length>0&&(uri+="&defects="+defect_types.join()),window.location=uri},$scope.split=function(groupName,filterExpression){if(1==$scope.groups.length)$scope.groups=[];else{for(var index=-1,i=0,len=$scope.groups.length;i<len;i++)if("Remainder"===$scope.groups[i].keyword){index=i;break}index>-1&&$scope.groups.splice(index,1)}var matchingBuilds=$filter("filter")($scope.cdash.builds,filterExpression);$scope.addGroup(groupName,matchingBuilds);var remainingBuilds=$filter("filter")($scope.cdash.builds,function(value,index,array){for(var keep_this_build=!0,i=0;i<$scope.groups.length;++i){for(var group=$scope.groups[i],j=0;j<group.builds.length;++j){var build=group.builds[j];if(value.id==build.id){keep_this_build=!1;break}}if(!keep_this_build)break}return keep_this_build});$scope.addGroup("Remainder",remainingBuilds),$scope.computeChartData(),$scope.rerenderChart()},$scope.unsplit=function(groupName){for(var idx_to_remove=-1,i=0,len=$scope.groups.length;i<len;i++)if($scope.groups[i].keyword===groupName){idx_to_remove=i;break}if(idx_to_remove!==-1){for(var groupToRemove=$scope.groups[idx_to_remove],idx_remain=-1,i=0,len=$scope.groups.length;i<len;i++)if("Remainder"===$scope.groups[i].keyword){idx_remain=i;break}if(idx_remain!==-1){for(var buildids_to_move=[],i=0,len1=groupToRemove.builds.length;i<len1;i++){for(var build=groupToRemove.builds[i],move_this_build=!0,j=0,len2=$scope.groups.length;j<len2;j++){var group=$scope.groups[j];if(j!==idx_to_remove&&"Remainder"!==group.keyword){for(var k=0,len3=group.builds.length;k<len3;k++)if(group.builds[k].id===build.id){move_this_build=!1;break}if(!move_this_build)break}}move_this_build&&buildids_to_move.push(groupToRemove.builds[i].id)}var filterExpression=function(value,index,array){return buildids_to_move.indexOf(value.id)!==-1},matchingBuilds=$filter("filter")($scope.cdash.builds,filterExpression);$scope.groups[idx_remain].builds=$scope.groups[idx_remain].builds.concat(matchingBuilds),$scope.groups.splice(idx_to_remove,1);for(var i=0,len=$scope.groups.length;i<len;i++)$scope.groups[i].position=i;1==$scope.groups.length&&($scope.groups[0].keyword="All"),$scope.computeChartData(),$scope.rerenderChart()}}},$scope.rerenderChart=function(){$scope.chart_selection.datum($scope.chart_data).transition().duration(500).call($scope.chart),nv.utils.windowResize($scope.chart.update)},$scope.addSelection=function(){var selection=[{name:"",comparator:"",comparators:[],property:"",applied:!1}];$scope.cdash.selections.push(selection)},$scope.removeSelection=function(selection){var index=$scope.cdash.selections.indexOf(selection);index>-1&&($scope.cdash.selections.splice(index,1),$scope.unsplit(selection.name))},$scope.applySelection=function(selection){var user_clause=selection.property+" "+selection.comparator.symbol+" "+selection.value,actual_code="value.properties."+user_clause,filterExpression=function(value,index,array){try{var b=eval(actual_code)}catch(err){selection.error=err.message}return!!b};selection.applied=!0,$scope.split(selection.name,filterExpression),$scope.addSelection()},$scope.updateComparators=function(selection){var idx=$scope.cdash.propertykeys.indexOf(selection.property);if(idx!=-1){var type=$scope.cdash.properties[selection.property].type;selection.comparators=$scope.comparators[type]}},$scope.showModal=function(defect){$scope.cdash.currentDefect=defect,modalSvc.showModal(null,function(){},"modal-template",$scope,"lg")},$scope.toggleDefects=function(){$scope.cdash.defectsLoaded?$scope.cdash.showDefects=!$scope.cdash.showDefects:$scope.loadDefects()},$scope.loadDefects=function(){$scope.cdash.loadingDefects=!0;for(var buildids=[],i=0;i<$scope.cdash.builds.length;++i)buildids.push($scope.cdash.builds[i].id);for(var defect_types=[],i=0;i<$scope.cdash.defecttypes.length;++i){var defect_type=$scope.cdash.defecttypes[i];defect_type.selected&&defect_types.push(defect_type.name)}var parameters={"buildid[]":buildids,"defect[]":defect_types};$scope.cdash.defectsError="",$http({url:"api/v1/buildProperties.php",method:"GET",params:parameters}).then(function(s){$scope.cdash.defects=s.data.defects;for(var i=0;i<$scope.cdash.defects.length;++i)$scope.cdash.defects[i].classifiersLoaded=!1,$scope.cdash.defects[i].loadingClassifiers=!1,$scope.cdash.defects[i].showClassifiers=!1;$scope.cdash.defects=$filter("orderBy")($scope.cdash.defects,$scope.orderByFields),$scope.cdash.defectsLoaded=!0,$scope.cdash.showDefects=!0,$scope.pageChanged()},function(e){$scope.cdash.defectsError=e.data})["finally"](function(){$scope.cdash.loadingDefects=!1})},$scope.toggleClassifiers=function(defect){defect.classifiersLoaded||$scope.computeClassifiers(defect),defect.showClassifiers=!defect.showClassifiers},$scope.computeClassifiers=function(defect){defect.loadingClassifiers=!0;for(var i=0;i<$scope.cdash.builds.length;++i)defect.builds.indexOf($scope.cdash.builds[i].id)===-1?$scope.cdash.builds[i].success=!0:$scope.cdash.builds[i].success=!1;var parameters={"builds[]":$scope.cdash.builds};$http({url:"api/v1/computeClassifier.php",method:"GET",params:parameters}).then(function(s){defect.classifiers=s.data,defect.classifiersLoaded=!0},function(e){$scope.cdash.warning=e.data})["finally"](function(){defect.loadingClassifiers=!1})},$scope.pageChanged=function(){var begin=($scope.pagination.currentPage-1)*$scope.pagination.numPerPage,end=begin+$scope.pagination.numPerPage;end>0?$scope.pagination.filteredDefects=$scope.cdash.defects.slice(begin,end):$scope.pagination.filteredDefects=$scope.cdash.defects},$scope.numDefectsPerPageChanged=function(){$.cookie("buildProperties_num_per_page",$scope.pagination.numPerPage,{expires:365}),$scope.pageChanged()},$scope.updateOrderByFields=function(field,$event){multisort.updateOrderByFields($scope,field,$event),$scope.cdash.defects=$filter("orderBy")($scope.cdash.defects,$scope.orderByFields),$scope.pageChanged(),$.cookie("cdash_buildProperties_sort",$scope.orderByFields)}});
CDash.controller("BuildSummaryController",function($scope,$http,$location,$timeout,anchors,apiLoader){$scope.showTimeGraph=!1,$scope.showErrorGraph=!1,$scope.showWarningGraph=!1,$scope.showTestGraph=!1,$scope.showHistoryGraph=!1,$scope.showNote=!1,$scope.graphLoading=!1,$scope.graphLoaded=!1,$scope.graphData=[],$scope.graphRendered={time:!1,errors:!1,warnings:!1,tests:!1},apiLoader.loadPageData($scope,"api/v1/buildSummary.php"),$scope.finishSetup=function(){$scope.cdash.noteStatus="0",$scope.jumpToAnchor=anchors.jumpToAnchor,""!=$location.hash()&&anchors.jumpToAnchor($location.hash())},$scope.toggleTimeGraph=function(){$scope.showTimeGraph=!$scope.showTimeGraph,$timeout(function(){$scope.graphLoaded?$scope.renderGraph("time"):$scope.loadGraphData("time")},1)},$scope.toggleErrorGraph=function(){$scope.showErrorGraph=!$scope.showErrorGraph,$timeout(function(){$scope.graphLoaded?$scope.renderGraph("errors"):$scope.loadGraphData("errors")},1)},$scope.toggleWarningGraph=function(){$scope.showWarningGraph=!$scope.showWarningGraph,$timeout(function(){$scope.graphLoaded?$scope.renderGraph("warnings"):$scope.loadGraphData("warnings")},1)},$scope.toggleTestGraph=function(){$scope.showTestGraph=!$scope.showTestGraph,$timeout(function(){$scope.graphLoaded?$scope.renderGraph("tests"):$scope.loadGraphData("tests")},1)},$scope.toggleHistoryGraph=function(){$scope.showHistoryGraph=!$scope.showHistoryGraph,$scope.loadGraphData()},$scope.loadGraphData=function(graphType){$scope.graphLoading=!0,$http({url:"api/v1/getPreviousBuilds.php",method:"GET",params:{buildid:$scope.cdash.build.id}}).then(function(s){var resp=s.data;$scope.cdash.buildtimes=[],$scope.cdash.builderrors=[],$scope.cdash.buildwarnings=[],$scope.cdash.testfailed=[],$scope.cdash.buildids=[],$scope.cdash.buildhistory=[];for(var builds=resp.builds,i=0,len=builds.length;i<len;i++){var build=builds[i],t=build.timestamp;$scope.cdash.buildtimes.push([t,build.time/60]),$scope.cdash.builderrors.push([t,build.builderrors]),$scope.cdash.buildwarnings.push([t,build.buildwarnings]),$scope.cdash.testfailed.push([t,build.testfailed]),$scope.cdash.buildids[t]=build.id;var history_build=[];history_build.id=build.id,history_build.nfiles=build.nfiles,history_build.configureerrors=build.configureerrors,history_build.configurewarnings=build.configurewarnings,history_build.builderrors=build.builderrors,history_build.buildwarnings=build.buildwarnings,history_build.testfailed=build.testfailed,history_build.starttime=build.starttime,$scope.cdash.buildhistory.push(history_build)}$scope.graphLoaded=!0,graphType&&$scope.renderGraph(graphType)})["finally"](function(){$scope.graphLoading=!1})},$scope.renderGraph=function(graphType){if(!$scope.graphRendered[graphType]){var data,element,label,options={lines:{show:!0},points:{show:!0},xaxis:{mode:"time"},grid:{backgroundColor:"#fffaff",clickable:!0,hoverable:!0,hoverFill:"#444",hoverRadius:4},selection:{mode:"x"}};switch(graphType){case"time":options.colors=["#41A317"],options.yaxis={tickFormatter:function(v,axis){return v.toFixed(axis.tickDecimals)+" mins"}},data=$scope.cdash.buildtimes,element="#buildtimegrapholder",label="Build Time";break;case"errors":options.colors=["#FF0000"],options.yaxis={minTickSize:1},data=$scope.cdash.builderrors,element="#builderrorsgrapholder",label="# errors";break;case"warnings":options.colors=["#FDD017"],options.yaxis={minTickSize:1},data=$scope.cdash.buildwarnings,element="#buildwarningsgrapholder",label="# warnings";break;case"tests":options.colors=["#0000FF"],options.yaxis={minTickSize:1},data=$scope.cdash.testfailed,element="#buildtestsfailedgrapholder",label="# tests failed";break;default:return}var plot=$.plot($(element),[{label:label,data:data}],options);$(element).bind("selected",function(event,area){var axes=plot.getAxes(),xaxis=axes.xaxis.options;xaxis.min=area.x1,xaxis.max=area.x2,plot.clearSelection(),plot.setupGrid(),plot.draw()}),$(element).bind("plotclick",function(e,pos,item){item&&(plot.highlight(item.series,item.datapoint),buildid=buildids[item.datapoint[0]],window.location="buildSummary.php?buildid="+buildid)}),$(element).bind("dblclick",function(event){var axes=plot.getAxes(),xaxis=axes.xaxis.options,yaxis=axes.yaxis.options;xaxis.min=null,xaxis.max=null,yaxis.min=null,yaxis.max=null,plot.setupGrid(),plot.draw()}),$scope.graphRendered[graphType]=!0}},$scope.toggleNote=function(){$scope.showNote=!$scope.showNote},$scope.addNote=function(){var parameters={buildid:$scope.cdash.build.id,Status:$scope.cdash.noteStatus,AddNote:$scope.cdash.noteText};$http.post("api/v1/addUserNote.php",parameters).then(function(s){$scope.cdash.notes.push(s.data.note)},function(e){$scope.cdash.error=e.data.error})}});
CDash.controller("CompareCoverageController",function($scope,$rootScope,apiLoader,filters,multisort){$scope.showfilters=!1,$rootScope.queryString.filterstring=filters.getString(),$scope.sortCoverage={orderByFields:[]},apiLoader.loadPageData($scope,"api/v1/compareCoverage.php"),$scope.showfilters_toggle=function(){$scope.showfilters=!$scope.showfilters,filters.toggle($scope.showfilters)},$scope.updateOrderByFields=function(obj,field,$event){multisort.updateOrderByFields(obj,field,$event)}});
CDash.controller("CreateProjectController",function($scope,$http,$location,$timeout,apiLoader,Upload){apiLoader.loadPageData($scope,"api/v1/createProject.php"),$scope.finishSetup=function(){$scope.cdash.changesmade=!1;var activeTab=1,disableTabs=!1,hash=$location.hash();if(hash.startsWith("tab")){var whichTab=hash.match(/\d+/);whichTab&&(activeTab=whichTab)}0==$scope.cdash.edit&&(disableTabs=!0,$scope.cdash.submitdisabled=!0),$scope.cdash.tabs=[{disabled:!1,active:1==activeTab},{disabled:disableTabs,active:2==activeTab},{disabled:disableTabs,active:3==activeTab},{disabled:disableTabs,active:4==activeTab},{disabled:disableTabs,active:5==activeTab},{disabled:disableTabs,active:6==activeTab}],1==$scope.cdash.edit&&($scope.cdash.tabs.push({disabled:!1,active:7==activeTab}),$scope.cdash.tabs.push({disabled:!1,active:8==activeTab})),$scope.cdash.bugtrackerexamples={Buganizer:"<bug-url>/new?component=###&template=###",GitHub:"https://github.com/:owner/:repo/issues/new?",JIRA:"<bug-url>/secure/CreateIssueDetails!init.jspa?pid=###&issuetype=#"},$scope.cdash.bugtrackertypes=Object.keys($scope.cdash.bugtrackerexamples),$scope.cdash.project.BugTrackerType&&$scope.cdash.project.BugTrackerNewIssueUrl?$scope.cdash.issuecreation=!0:$scope.cdash.issuecreation=!1},$scope.showHelp=function(id_div){$(".tab_help").html($("#"+id_div).html()).show()},$scope.clearHelp=function(){$(".tab_help").html("")},$scope.nextTab=function(idx){return 0!=idx||void 0!==$scope.cdash.project.Name&&""!=$scope.cdash.project.Name?($scope.gotoTab(idx+1),void(4==idx&&($scope.cdash.submitdisabled=!1))):(alert("please specify a name for the project."),!1)},$scope.previousTab=function(idx){$scope.gotoTab(idx-1)},$scope.gotoTab=function(idx){$scope.clearHelp();for(var i=0;i<$scope.cdash.tabs.length;i++)$scope.cdash.tabs[i].active=!1;$scope.cdash.tabs[idx].disabled=!1,$scope.cdash.tabs[idx].active=!0,$scope.setTab(idx)},$scope.setTab=function(idx){$location.hash("tab"+idx)},$scope.createProject=function(){var parameters={Submit:!0,project:$scope.cdash.project};$http.post("api/v1/project.php",parameters).then(function(s){var cdash=s.data;cdash.projectcreated&&cdash.project&&($scope.cdash.projectcreated=cdash.projectcreated,$scope.cdash.project=cdash.project,$scope.setLogo())},function(e){$scope.cdash.error=e.data.error})},$scope.updateProject=function(){var parameters={Update:!0,project:$scope.cdash.project};$http.post("api/v1/project.php",parameters).then(function(s){var cdash=s.data;cdash.projectupdated&&cdash.project&&($scope.cdash.changesmade=!1,$scope.cdash.projectupdated=!0,$scope.cdash.project=cdash.project,$scope.setLogo(),$scope.startFade=!1,$timeout(function(){$scope.cdash.projectupdated=!1,$scope.startFade=!0},2e3))},function(e){$scope.cdash.error=e.data.error})},$scope.setLogo=function(){$scope.cdash.logoFile&&Upload.upload({url:"api/v1/project.php",data:{project:$scope.cdash.project,logo:$scope.cdash.logoFile}}).then(function(resp){if(resp.data.imageid>0){$scope.cdash.logoFile=null;var imageid=resp.data.imageid+"&decache="+(new Date).getTime();$scope.cdash.project.ImageId=imageid,$scope.cdash.logoid=imageid}})},$scope.deleteProject=function(){if(window.confirm("Are you sure you want to delete this project?")){var parameters={project:$scope.cdash.project};$http({url:"api/v1/project.php",method:"DELETE",params:parameters}).then(function(){window.location="user.php"})}},$scope.changeViewerType=function(){if($scope.cdash.selectedViewer&&($scope.cdash.project.CvsViewerType=$scope.cdash.selectedViewer.value,$scope.cdash.project.CvsUrl)){var parameters={method:"repository",task:"exampleurl",url:$scope.cdash.project.CvsUrl,type:$scope.cdash.selectedViewer.value};$http({url:"api/v1/index_old.php",method:"GET",params:parameters}).then(function(s){$scope.cdash.repositoryurlexample=s.data})}},$scope.addRepository=function(){$scope.cdash.project.repositories.push({url:"",branch:"",username:"",password:""})},$scope.addBlockedBuild=function(blockedbuild){var parameters={project:$scope.cdash.project,AddBlockedBuild:blockedbuild};$http.post("api/v1/project.php",parameters).then(function(s){var cdash=s.data;cdash.blockedid>0&&(blockedbuild.id=cdash.blockedid,$scope.cdash.project.blockedbuilds.push(blockedbuild),$scope.cdash.buildblocked=!0,$scope.startFade=!1,$timeout(function(){$scope.cdash.buildblocked=!1,$scope.startFade=!0},2e3))},function(e){$scope.cdash.error=e.data.error})},$scope.removeBlockedBuild=function(blockedbuild){var parameters={project:$scope.cdash.project,RemoveBlockedBuild:blockedbuild};$http.post("api/v1/project.php",parameters).then(function(s){for(var index=(s.data,-1),i=0,len=$scope.cdash.project.blockedbuilds.length;i<len;i++)if($scope.cdash.project.blockedbuilds[i].id===blockedbuild.id){index=i;break}index>-1&&$scope.cdash.project.blockedbuilds.splice(index,1)},function(e){$scope.cdash.error=e.data.error})},$scope.changeTrackerType=function(){$scope.cdash.project.BugTrackerType&&(!$scope.cdash.project.BugTrackerType in $scope.cdash.bugtrackerexamples?$scope.cdash.newissuehelp="":$scope.cdash.newissuehelp=$scope.cdash.bugtrackerexamples[$scope.cdash.project.BugTrackerType])}});
function FiltersController($scope,$rootScope,$http,$timeout){$scope.filterdefinitions={buildduration:{text:"Build Duration",type:"number",defaultvalue:0},builderrors:{text:"Build Errors",type:"number",defaultvalue:0},buildgenerator:{text:"Submission Client",type:"string",defaultvalue:"2.8"},buildname:{text:"Build Name",type:"string",defaultvalue:""},buildstamp:{text:"Build Stamp",type:"string",defaultvalue:""},buildstarttime:{text:"Build Start Time",type:"date",defaultvalue:""},buildtype:{text:"Build Type",type:"string",defaultvalue:"Nightly"},buildwarnings:{text:"Build Warnings",type:"number",defaultvalue:0},configureduration:{text:"Configure Duration",type:"number",defaultvalue:0},configureerrors:{text:"Configure Errors",type:"number",defaultvalue:0},configurewarnings:{text:"Configure Warnings",type:"number",defaultvalue:0},coveredlines:{text:"Covered Lines",type:"number",defaultvalue:0},details:{text:"Details",type:"string",defaultvalue:""},expected:{text:"Expected",type:"bool",defaultvalue:""},filename:{text:"Filename",type:"string",defaultvalue:""},groupname:{text:"Group",type:"string",defaultvalue:"Nightly"},hascoverage:{text:"Has Coverage",type:"bool",defaultvalue:""},hasctestnotes:{text:"Has CTest Notes",type:"bool",defaultvalue:""},hasdynamicanalysis:{text:"Has Dynamic Analysis",type:"bool",defaultvalue:""},hasusernotes:{text:"Has User Notes",type:"bool",defaultvalue:""},label:{text:"Label",type:"string",defaultvalue:""},priority:{text:"Priority",type:"string",defaultvalue:""},revision:{text:"Revision",type:"string",defaultvalue:""},site:{text:"Site",type:"string",defaultvalue:""},status:{text:"Status",type:"string",defaultvalue:""},subproject:{text:"SubProject",type:"string",defaultvalue:""},subprojects:{text:"SubProjects",type:"list",defaultvalue:"",content:!0},testname:{text:"Test Name",type:"string",defaultvalue:""},testoutput:{text:"Test Output",type:"search",defaultvalue:"",content:!0},testsduration:{text:"Tests Duration",type:"number",defaultvalue:0},testsfailed:{text:"Tests Failed",type:"number",defaultvalue:0},testsnotrun:{text:"Tests Not Run",type:"number",defaultvalue:0},testspassed:{text:"Tests Passed",type:"number",defaultvalue:0},testtimestatus:{text:"Tests Timing Failed",type:"number",defaultvalue:0},time:{text:"Time",type:"number",defaultvalue:""},timestatus:{text:"Time Status",type:"string",defaultvalue:""},totallines:{text:"Total Lines",type:"number",defaultvalue:0},uncoveredlines:{text:"Uncovered Lines",type:"number",defaultvalue:0},updateduration:{text:"Update Duration",type:"number",defaultvalue:0},updatedfiles:{text:"Updated Files",type:"number",defaultvalue:0}},$scope.comparisons={bool:[{value:1,text:"is true"},{value:2,text:"is false"}],date:[{value:81,text:"is"},{value:82,text:"is not"},{value:83,text:"is after"},{value:84,text:"is before"}],number:[{value:41,text:"is"},{value:42,text:"is not"},{value:43,text:"is greater than"},{value:44,text:"is less than"}],search:[{value:94,text:"exclude"},{value:95,text:"include"},{value:96,text:"exclude regex"},{value:97,text:"include regex"}],string:[{value:63,text:"contains"},{value:64,text:"does not contain"},{value:61,text:"is"},{value:62,text:"is not"},{value:65,text:"starts with"},{value:66,text:"ends with"}],list:[{value:92,text:"exclude"},{value:93,text:"include"}]},$scope.addFilter=function(block,index){var previous_filter=block.filters[index-1];if(previous_filter.hasOwnProperty("filters"))var filter_to_copy=previous_filter.filters[previous_filter.filters.length-1];else var filter_to_copy=previous_filter;var filter={field:filter_to_copy.field,compare:filter_to_copy.compare,value:filter_to_copy.value};block.filters.splice(index,0,filter)},$scope.removeFilter=function(block,index){block.filters.splice(index-1,1)},$scope.changeFilter=function(filter){var type=$scope.filterdefinitions[filter.field].type,comparisons=$scope.comparisons[type],found=!1;for(i in comparisons)if(comparisons[i].value==filter.compare){found=!0;break}found||(filter.compare="0")},$scope.applyFilters=function(){var url=this.createHyperlink();window.location.href=url},$scope.clearFilters=function(){$scope.filterdata.filters=[],$scope.applyFilters()},$scope.displayHyperlink=function(){var url=this.createHyperlink();$("#div_filtersAsUrl").html('<a href="'+url+'">'+url+"</a>")},$scope.createHyperlink=function(){for(var n=$scope.filterdata.filters.length,params=window.location.search.replace("?","").split(/[&;]/g),filterParams=["filtercount","filtercombine","showfilters","field","compare","value","limit","date","begin","end"],i=params.length;i-- >0;)for(var j=0;j<filterParams.length;j++)if(params[i].startsWith(filterParams[j])){params.splice(i,1);break}for(var s=window.location.origin+window.location.pathname+"?",i=0;i<params.length;i++)s+=params[i]+"&";if($scope.cdash.begin&&$scope.cdash.end)s+=$scope.cdash.begin==$scope.cdash.end?"date="+$scope.cdash.begin+"&":"begin="+$scope.cdash.begin+"&end="+$scope.cdash.end+"&";else if($scope.cdash.begin||$scope.cdash.end){var date=$scope.cdash.begin?$scope.cdash.begin:$scope.cdash.end;s+="date="+date+"&"}else($scope.cdash.begin||$scope.cdash.end)&&$scope.cdash.date_set&&$scope.cdash.date&&(s+="date="+$scope.cdash.date+"&");s=s+"filtercount="+n,s+="&showfilters=1",l=$("#id_limit").val(),0!=l&&(s=s+"&limit="+l),n>1&&(s=s+"&filtercombine="+$scope.filterdata.filtercombine);for(var i=1;i<=n;i++)if($scope.filterdata.filters[i-1].hasOwnProperty("filters")){var num_subfilters=$scope.filterdata.filters[i-1].filters.length;if(num_subfilters<1)continue;var prefix="field"+i;s=s+"&"+prefix+"=block",s=s+"&"+prefix+"count="+num_subfilters;for(var j=1;j<=num_subfilters;j++)s=s+"&"+prefix+"field"+j+"="+encodeURIComponent($scope.filterdata.filters[i-1].filters[j-1].field),s=s+"&"+prefix+"compare"+j+"="+encodeURIComponent($scope.filterdata.filters[i-1].filters[j-1].compare),s=s+"&"+prefix+"value"+j+"="+encodeURIComponent($scope.filterdata.filters[i-1].filters[j-1].value)}else s=s+"&field"+i+"="+encodeURIComponent($scope.filterdata.filters[i-1].field),s=s+"&compare"+i+"="+encodeURIComponent($scope.filterdata.filters[i-1].compare),s=s+"&value"+i+"="+encodeURIComponent($scope.filterdata.filters[i-1].value);return s},$scope.addFilterBlock=function(index){var parent_filter=$scope.filterdata.filters[index-1],or_block={filters:[]},filter={field:parent_filter.field,compare:parent_filter.compare,value:parent_filter.value};or_block.filters.push(filter),$scope.filterdata.filters.splice(index,0,or_block)},$scope.updateCombine=function(filterdata){"or"==filterdata.filtercombine?filterdata.othercombine="and":filterdata.othercombine="or"};var url=window.location.pathname,filename=url.substring(url.lastIndexOf("/")+1),filename_for_docs=filename;"index.php"===filename&&"parentid"in $rootScope.queryString&&(filename="indexchildren.php"),$rootScope.queryString.page_id=filename,$rootScope.queryString.showlimit=0,$http({url:"api/v1/filterdata.php",method:"GET",params:$rootScope.queryString}).then(function(s){var filterdata=s.data;filterdata.filters.forEach(function(filter){filter.hasOwnProperty("filters")?filter.filters.forEach(function(subfilter){subfilter.compare=subfilter.compare.toString()}):filter.hasOwnProperty("compare")&&(filter.compare=filter.compare.toString())}),filterdata.availablenoncontentfilters=filterdata.availablefilters.slice(),filterdata.availablenoncontentfilters.forEach(function(availablefilter,index,object){var filter_definition=$scope.filterdefinitions[availablefilter];filter_definition.hasOwnProperty("content")&&filter_definition.content&&object.splice(index,1)}),$scope.filterdata=filterdata,$scope.cdash.page=filename_for_docs,$scope.cdash.date_set&&$scope.cdash.date&&($scope.cdash.begin||($scope.cdash.begin=$scope.cdash.date),$scope.cdash.end||($scope.cdash.end=$scope.cdash.date))})}angular.module("CDash").controller("FiltersController",FiltersController),angular.module("CDash").directive("filterRow",function(VERSION){return{templateUrl:"build/views/partials/filterRow_"+VERSION+".html"}}),angular.module("CDash").directive("filterButtons",function(VERSION){return{templateUrl:"build/views/partials/filterButtons_"+VERSION+".html"}});
CDash.controller("HeadController",function($rootScope,$document){$rootScope.readCookie=function(name){for(var nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return null};var colorblind=$rootScope.readCookie("colorblind");1==colorblind?$rootScope.cssfile="colorblind":$rootScope.cssfile="cdash",$rootScope.queryString={};for(var match,pl=/\+/g,search=/([^&=]+)=?([^&]*)/g,decode=function(s){return decodeURIComponent(s.replace(pl," "))},query=window.location.search.substring(1);match=search.exec(query);)$rootScope.queryString[decode(match[1])]=decode(match[2]);$rootScope.setupCalendar=function(date){date?(year=date.substr(0,4),8==date.length?(month=date.substr(4,2),day=date.substr(6,2)):(month=date.substr(5,2),day=date.substr(8,2)),$("#calendar").datepicker({onSelect:$rootScope.calendarSelected,defaultDate:new Date(month+"/"+day+"/"+year),maxDate:"0D"})):$("#calendar").datepicker({onSelect:$rootScope.calendarSelected,maxDate:"0D"})},$rootScope.calendarSelected=function(dateStr){var dateValue=dateStr.substr(6,4)+"-"+dateStr.substr(0,2)+"-"+dateStr.substr(3,2),uri=window.location.href,dateStr="&date="+dateValue;uri=uri.replace(/(&begin=)[^\&]+/,""),uri=uri.replace(/(&end=)[^\&]+/,""),uri=uri.replace(/(&date=)[^\&]+/,"");var filterIdx=uri.indexOf("&filter");filterIdx>-1?uri=uri.slice(0,filterIdx)+dateStr+uri.slice(filterIdx):uri+=dateStr,window.location=uri,$("#calendar").hide()},$rootScope.toggleCalendar=function(){$("#calendar").hasClass("hasDatepicker")||("date"in $rootScope.queryString?$rootScope.setupCalendar($rootScope.queryString.date):$rootScope.setupCalendar()),$("#calendar").toggle()}});
CDash.filter("showEmptyBuildsLast",function(){return function(builds,sortField){if(angular.isArray(builds)){var nonempty=builds.filter(function(build){return!("expectedandmissing"in build)}),expecteds=builds.filter(function(build){return"expectedandmissing"in build});if(angular.isArray(sortField)){if(sortField.length<1)return nonempty.concat(expecteds);sortField=sortField[0]}"-"==sortField.charAt(0)&&(sortField=sortField.substring(1));var idx=sortField.indexOf(".");if(idx===-1)return nonempty.concat(expecteds);var dataField=sortField.substr(0,idx),present=nonempty.filter(function(build){return dataField in build}),missing=nonempty.filter(function(build){return!(dataField in build)});return present=present.concat(missing),present.concat(expecteds)}}}).controller("IndexController",function($scope,$rootScope,$location,$http,$filter,$timeout,anchors,apiLoader,filters,multisort,modalSvc){$scope.loading=!0,$scope.showfilters=!1,$scope.showsettings=!1;var feed_cookie=$.cookie("cdash_hidefeed");feed_cookie?$scope.showFeed=!1:$scope.showFeed=!0;var timer,refresh_cookie=$.cookie("cdash_refresh");refresh_cookie?($scope.autoRefresh=!0,timer=$timeout(function(){window.location.reload(!0)},5e3)):$scope.autoRefresh=!1,$scope.showTimelineChart=!1,$rootScope.queryString.filterstring=filters.getString();var query_sort_order=[];"sort"in $rootScope.queryString&&(query_sort_order=$rootScope.queryString.sort.split(",")),apiLoader.loadPageData($scope,"api/v1/index.php"),$scope.finishSetup=function(){var sort_order=[],cookie_value=$.cookie("cdash_"+$scope.cdash.projectname+"_coverage_sort");cookie_value&&(sort_order=cookie_value.split(",")),$scope.sortCoverage={orderByFields:sort_order},sort_order=[],cookie_value=$.cookie("cdash_"+$scope.cdash.projectname+"_DA_sort"),cookie_value&&(sort_order=cookie_value.split(",")),$scope.sortDA={orderByFields:sort_order},sort_order=[],cookie_value=$.cookie("cdash_"+$scope.cdash.projectname+"_subproject_sort"),cookie_value&&(sort_order=cookie_value.split(",")),$scope.sortSubProjects={orderByFields:sort_order};var num_per_page_cookie=$.cookie("num_builds_per_page");"buildgroup"in $rootScope.queryString&&($scope.showTimelineChart=!0,$scope.cdash.buildgroup=$rootScope.queryString.buildgroup);for(var i in $scope.cdash.buildgroups)if($scope.cdash.buildgroups.hasOwnProperty(i)){$scope.cdash.buildgroups[i].pagination=[],$scope.cdash.buildgroups[i].pagination.filteredBuilds=[],$scope.cdash.buildgroups[i].pagination.currentPage=1,$scope.cdash.buildgroups[i].pagination.maxSize=5,num_per_page_cookie?$scope.cdash.buildgroups[i].pagination.numPerPage=parseInt(num_per_page_cookie):$scope.cdash.buildgroups[i].pagination.numPerPage=10;var sorting_set=!1;if(query_sort_order.length>0)$scope.cdash.buildgroups[i].orderByFields=query_sort_order,sorting_set=!0;else{var cookie_name=$scope.getCookieName($scope.cdash.buildgroups[i],$scope.cdash.projectname,$scope.cdash.childview),sort_cookie_value=$.cookie(cookie_name);sort_cookie_value&&(sort_order=sort_cookie_value.split(","),$scope.cdash.buildgroups[i].orderByFields=sort_order,sorting_set=!0)}sorting_set||($scope.cdash.buildgroups[i].orderByFields=[],1==$scope.cdash.childview?($scope.cdash.buildgroups[i].numbuilderror>0?$scope.cdash.buildgroups[i].orderByFields.push("-compilation.error"):$scope.cdash.buildgroups[i].numconfigureerror>0&&$scope.cdash.buildgroups[i].orderByFields.push("-configure.error"),$scope.cdash.buildgroups[i].numtestfail>0&&$scope.cdash.buildgroups[i].orderByFields.push("-test.fail"),$scope.cdash.buildgroups[i].orderByFields.push("builddatefull")):"sorttype"in $scope.cdash.buildgroups[i]?"time"==$scope.cdash.buildgroups[i].sorttype&&$scope.cdash.buildgroups[i].orderByFields.push("-builddatefull"):($scope.cdash.buildgroups[i].numconfigureerror>0&&$scope.cdash.buildgroups[i].orderByFields.push("-configure.error"),$scope.cdash.buildgroups[i].numbuilderror>0&&$scope.cdash.buildgroups[i].orderByFields.push("-compilation.error"),$scope.cdash.buildgroups[i].numtestfail>0&&$scope.cdash.buildgroups[i].orderByFields.push("-test.fail"),$scope.cdash.buildgroups[i].numtestnotrun>0&&$scope.cdash.buildgroups[i].orderByFields.push("-test.notrun"),$scope.cdash.buildgroups[i].numconfigurewarning>0&&$scope.cdash.buildgroups[i].orderByFields.push("-configure.warning"),$scope.cdash.buildgroups[i].numbuildwarning>0&&$scope.cdash.buildgroups[i].orderByFields.push("-compilation.warning"),$scope.cdash.buildgroups[i].orderByFields.push("-builddatefull"))),$scope.cdash.buildgroups[i].builds=$filter("orderBy")($scope.cdash.buildgroups[i].builds,$scope.cdash.buildgroups[i].orderByFields),$scope.cdash.buildgroups[i].builds=$filter("showEmptyBuildsLast")($scope.cdash.buildgroups[i].builds,$scope.cdash.buildgroups[i].orderByFields),!$scope.cdash.buildgroups[i].hasnormalbuilds&&!$scope.cdash.buildgroups[i].hasparentbuilds&&$scope.cdash.buildgroups[i].builds.length>0&&($scope.cdash.buildgroups[i].hasnormalbuilds=!0),$scope.pageChanged($scope.cdash.buildgroups[i])}$scope.cdash.extrafilterurl="",$scope.cdash.sharelabelfilters&&($scope.cdash.extrafilterurl=filters.getLabelString($scope.cdash.filterdata));var advanced_cookie=$.cookie("cdash_"+$scope.cdash.projectname+"_advancedview"),show_time_columns=0;1==advanced_cookie?($scope.cdash.advancedview=1,$scope.cdash.showstarttime&&(show_time_columns=1)):$scope.cdash.advancedview=0,$scope.cdash.showtimecolumns=show_time_columns,$scope.cdash.showtesttime||($scope.cdash.showtesttime=0!=$scope.cdash.advancedview&&$scope.cdash.showstarttime),$scope.cdash.extratestcolumns=0,$scope.cdash.showtesttime&&($scope.cdash.extratestcolumns+=1),$scope.cdash.advancedview&&$scope.cdash.showProcTime&&($scope.cdash.extratestcolumns+=1),$scope.cdash.numcolumns=14+$scope.cdash.extratestcolumns+$scope.cdash.displaylabels,$scope.cdash.feed_enabled||($scope.showFeed=!1);var projectid=$scope.cdash.projectid;projectid>0&&$scope.cdash.feed&&setInterval(function(){$scope.showFeed&&$("#feed").load("ajax/getfeed.php?projectid="+projectid,{},function(){$(this).fadeIn("slow")})},3e4),$scope.jumpToAnchor=anchors.jumpToAnchor,""!=$location.hash()&&anchors.jumpToAnchor($location.hash())},$scope.toggleFeed=function(){$scope.loading||($scope.showFeed=!$scope.showFeed,$scope.showFeed?($.cookie("cdash_hidefeed",null),$("#feed").load("ajax/getfeed.php?projectid="+$scope.cdash.projectid,{},function(){$(this).fadeIn("slow")})):$.cookie("cdash_hidefeed",1))},$scope.toggleAdvancedView=function(){1==$scope.cdash.advancedview?$scope.cdash.advancedview=0:$scope.cdash.advancedview=1,$.cookie("cdash_"+$scope.cdash.projectname+"_advancedview",$scope.cdash.advancedview),window.location.reload(!0)},$scope.URLencode=function(sStr){return escape(sStr).replace(/\+/g,"%2B").replace(/\"/g,"%22").replace(/\'/g,"%27")},$scope.toggleAdminOptions=function(build){"expectedandmissing"in build||"expected"in build&&(0==build.expected||1==build.expected)?"showAdminOptions"in build&&0!=build.showAdminOptions?build.showAdminOptions=0:build.showAdminOptions=1:(build.loading=1,$http({url:"api/v1/is_build_expected.php",method:"GET",params:{buildid:build.id}}).then(function(s){var response=s.data;build.loading=0,"expected"in response&&(build.expected=response.expected,"showAdminOptions"in build&&0!=build.showAdminOptions?build.showAdminOptions=0:build.showAdminOptions=1)}))},$scope.toggleBuildProblems=function(build){"hasErrors"in build?0==build.showProblems?build.showProblems=1:build.showProblems=0:(build.loading=1,$http({url:"api/v1/build.php",method:"GET",params:{buildid:build.id,getproblems:1}}).then(function(s){var response=s.data;build.loading=0,build.showProblems=1,build.hasErrors=response.hasErrors,build.failingSince=response.failingSince,build.failingDate=response.failingDate,build.daysWithErrors=response.daysWithErrors,build.hasFailingTests=response.hasFailingTests,build.testsFailingSince=response.testsFailingSince,build.testsFailingDate=response.testsFailingDate,build.daysWithFailingTests=response.daysWithFailingTests}))},$scope.toggleExpectedInfo=function(build){"lastSubmission"in build?0==build.showExpectedInfo?build.showExpectedInfo=1:build.showExpectedInfo=0:(build.loading=1,$http({url:"api/v1/expectedbuild.php",method:"GET",params:{siteid:build.siteid,groupid:build.buildgroupid,name:build.buildname,type:build.buildtype,currenttime:$scope.cdash.unixtimestamp}}).then(function(s){var response=s.data;build.loading=0,build.showExpectedInfo=1,build.lastSubmission=response.lastSubmission,build.lastSubmissionDate=response.lastSubmissionDate,build.daysSinceLastBuild=response.daysSinceLastBuild}))},$scope.showModal=function(buildid){modalSvc.showModal(buildid,$scope.removeBuild,"modal-template")},$scope.removeBuild=function(build){var parameters={buildid:build.id};$http({url:"api/v1/build.php",method:"DELETE",params:parameters}).then(function(){$scope.removeBuildFromScope(build)})},$scope.removeBuildFromScope=function(build){for(var idx1=-1,idx2=-1,i=0,len1=$scope.cdash.buildgroups.length;i<len1;i++){for(var j=0,len2=$scope.cdash.buildgroups[i].builds.length;j<len2;j++)if($scope.cdash.buildgroups[i].builds[j]===build){idx1=i,idx2=j;break}if(idx1!=-1)break}idx1>-1&&idx2>-1&&($scope.cdash.buildgroups[idx1].builds.splice(idx2,1),$scope.pageChanged($scope.cdash.buildgroups[idx1]))},$scope.toggleDone=function(build){var newDoneValue=1;1==build.done&&(newDoneValue=0);var parameters={buildid:build.id,done:newDoneValue};$http.post("api/v1/build.php",parameters).then(function(){build.done=newDoneValue})},$scope.toggleExpected=function(build,groupid){if(1==build.expectedandmissing){var parameters={siteid:build.siteid,groupid:build.buildgroupid,name:build.buildname,type:build.buildtype};$http({url:"api/v1/expectedbuild.php",method:"DELETE",params:parameters}).then(function(){$scope.removeBuildFromScope(build)})}else{var newExpectedValue=1;1==build.expected&&(newExpectedValue=0);var parameters={buildid:build.id,groupid:groupid,expected:newExpectedValue};$http.post("api/v1/build.php",parameters).then(function(){build.expected=newExpectedValue})}},$scope.toggleAutoRefresh=function(){var refresh_cookie=$.cookie("cdash_refresh");refresh_cookie?($timeout.cancel(timer),$scope.autoRefresh=!1,$.cookie("cdash_refresh",null)):($.cookie("cdash_refresh",1),window.location.reload(!0))},$scope.moveToGroup=function(build,groupid){if(1==build.expectedandmissing){var parameters={siteid:build.siteid,groupid:build.buildgroupid,newgroupid:groupid,name:build.buildname,type:build.buildtype};$http.post("api/v1/expectedbuild.php",parameters).then(function(){window.location.reload()})}else{var parameters={buildid:build.id,newgroupid:groupid,expected:build.expected};$http.post("api/v1/build.php",parameters).then(function(){window.location.reload()})}},$scope.colorblind_toggle=function(){$scope.cdash.filterdata.colorblind?($rootScope.cssfile="colorblind",$.cookie("colorblind",1,{expires:365})):($rootScope.cssfile="cdash",$.cookie("colorblind",0,{expires:365}))},$scope.showfilters_toggle=function(){$scope.showfilters=!$scope.showfilters,filters.toggle($scope.showfilters)},$scope.numBuildsPerPageChanged=function(obj){$.cookie("num_builds_per_page",obj.pagination.numPerPage,{expires:365}),$scope.pageChanged(obj)},$scope.pageChanged=function(obj){var begin=(obj.pagination.currentPage-1)*obj.pagination.numPerPage,end=begin+obj.pagination.numPerPage;end>0?obj.pagination.filteredBuilds=obj.builds.slice(begin,end):obj.pagination.filteredBuilds=obj.builds},$scope.updateOrderByFields=function(obj,field,$event,whichTable){whichTable=whichTable||"buildgroup";var cookie_name="";switch(multisort.updateOrderByFields(obj,field,$event),whichTable){case"buildgroup":default:cookie_name=$scope.getCookieName(obj,$scope.cdash.projectname,$scope.cdash.childview),obj.builds=$filter("orderBy")(obj.builds,obj.orderByFields),obj.builds=$filter("showEmptyBuildsLast")(obj.builds,obj.orderByFields),$scope.pageChanged(obj);break;case"coverage":cookie_name="cdash_"+$scope.cdash.projectname+"_coverage_sort";break;case"DA":cookie_name="cdash_"+$scope.cdash.projectname+"_DA_sort";break;case"subproject":cookie_name="cdash_"+$scope.cdash.projectname+"_subproject_sort"}$.cookie(cookie_name,obj.orderByFields)},$scope.normalBuild=function(build){return 0==build.numchildren||1==build.expectedandmissing},$scope.parentBuild=function(build){return build.numchildren>0||1==build.expectedandmissing},$scope.getCookieName=function(buildgroup,projectname,childview){var cookie_name="cdash_"+projectname;return cookie_name+=1==childview?"_child_index":"_index",cookie_name+=buildgroup.name,cookie_name+="_sort"}});
CDash.filter("filter_builds",function(){return function(input,group){if("undefined"==typeof group||null===group)return input;group_id=Number(group.id);for(var output=[],i=0;i<input.length;i++)Number(input[i].groupid)===group_id&&output.push(input[i]);return output}}).filter("filter_buildgroups",function(){return function(input,type){if("undefined"==typeof type||null===type)return input;for(var output=[],i=0;i<input.length;i++)input[i].type===type&&output.push(input[i]);return output}}).controller("ManageBuildGroupController",function($scope,$http,apiLoader,modalSvc){apiLoader.loadPageData($scope,"api/v1/manageBuildGroup.php"),$scope.finishSetup=function(){$scope.cdash.buildgroups&&($scope.cdash.buildgroups.sort(function(a,b){return Number(a.position)-Number(b.position)}),$scope.sortable={stop:function(e,ui){for(var index in $scope.cdash.buildgroups)$scope.cdash.buildgroups[index].position=index}}),$scope.cdash.buildgrouptypes=[{name:"Daily",value:"Daily"},{name:"Latest",value:"Latest"}],$scope.buildType=$scope.cdash.buildgrouptypes[0]},$scope.createBuildGroup=function(newBuildGroup,type){var parameters={projectid:$scope.cdash.projectid,newbuildgroup:newBuildGroup,type:type};$scope.cdash.buildgroup_error="",$http.post("api/v1/buildgroup.php",parameters).then(function(s){if(201==s.status){var buildgroup=s.data;$("#buildgroup_created").show(),$("#buildgroup_created").delay(3e3).fadeOut(400),$scope.cdash.buildgroups.push(buildgroup),"Daily"!=type&&$scope.cdash.dynamics.push(buildgroup)}else 200==s.status&&($scope.cdash.buildgroup_error="A group named '"+newBuildGroup+"' already exists for this project.")},function(e){$scope.cdash.buildgroup_error=e.data.error})},$scope.updateBuildGroupOrder=function(){var newLayout=getSortedElements("#sortable"),parameters={projectid:$scope.cdash.projectid,newLayout:newLayout};$http.post("api/v1/buildgroup.php",parameters).then(function(s){s.data.error?$scope.cdash.error=s.data.error:($("#order_updated").show(),$("#order_updated").delay(3e3).fadeOut(400))})},$scope.saveBuildGroup=function(buildgroup,summaryemail){var parameters={projectid:$scope.cdash.projectid,buildgroup:buildgroup};$http({url:"api/v1/buildgroup.php",method:"PUT",params:parameters}).then(function(s){s.data.error?$scope.cdash.error=s.data.error:($("#buildgroup_updated_"+buildgroup.id).show(),$("#buildgroup_updated_"+buildgroup.id).delay(3e3).fadeOut(400))})},$scope.deleteBuildGroup=function(buildgroupid){"use strict";var parameters={projectid:$scope.cdash.projectid,buildgroupid:buildgroupid};$http({url:"api/v1/buildgroup.php",method:"DELETE",params:parameters}).then(function(){for(var index=-1,i=0,len=$scope.cdash.buildgroups.length;i<len;i++)if($scope.cdash.buildgroups[i].id===buildgroupid){index=i;break}index>-1&&$scope.cdash.buildgroups.splice(index,1)})},$scope.showModal=function(buildgroupid){modalSvc.showModal(buildgroupid,$scope.deleteBuildGroup,"modal-template")},$scope.moveBuilds=function(builds,group,expected){var parameters={projectid:$scope.cdash.projectid,builds:builds,group:group,expected:expected};$http.post("api/v1/buildgroup.php",parameters).then(function(s){s.data.error?$scope.cdash.error=s.data.error:($("#builds_moved").show(),$("#builds_moved").delay(3e3).fadeOut(400))})},$scope.addWildcardRule=function(group,type,nameMatch){var parameters={projectid:$scope.cdash.projectid,group:group,type:type,nameMatch:nameMatch};$http.post("api/v1/buildgroup.php",parameters).then(function(s){s.data.error?$scope.cdash.error=s.data.error:($("#wildcard_defined").show(),$("#wildcard_defined").delay(3e3).fadeOut(400))})},$scope.deleteWildcardRule=function(wildcard){var parameters={projectid:$scope.cdash.projectid,wildcard:wildcard};$http({url:"api/v1/buildgroup.php",method:"DELETE",params:parameters}).then(function(){var index=$scope.cdash.wildcards.indexOf(wildcard);index>-1&&$scope.cdash.wildcards.splice(index,1)})},$scope.addDynamicRow=function(dynamic,buildgroup,site,match){var parameters={projectid:$scope.cdash.projectid,dynamic:dynamic,buildgroup:buildgroup,site:site,match:match};$http.post("api/v1/buildgroup.php",parameters).then(function(s){if(s.data.error)$scope.cdash.error=s.data.error;else{var idx=$scope.cdash.dynamics.indexOf(dynamic);idx>-1&&($scope.cdash.dynamics[idx].rules?$scope.cdash.dynamics[idx].rules.push(s.data):$scope.cdash.dynamics[idx].rules=[s.data]),$("#dynamic_defined").show(),$("#dynamic_defined").delay(3e3).fadeOut(400)}})},$scope.deleteDynamicRule=function(dynamic,rule){var parameters={projectid:$scope.cdash.projectid,dynamic:dynamic,rule:rule};$http({url:"api/v1/buildgroup.php",method:"DELETE",params:parameters}).then(function(){var idx1=$scope.cdash.dynamics.indexOf(dynamic);if(idx1>-1){var idx2=$scope.cdash.dynamics[idx1].rules.indexOf(rule);idx2>-1&&$scope.cdash.dynamics[idx1].rules.splice(idx2,1)}})}});
CDash.controller("ManageMeasurementsController",function($http,$scope,apiLoader,modalSvc){apiLoader.loadPageData($scope,"api/v1/manageMeasurements.php"),$scope.finishSetup=function(){for(var i=0,len=$scope.cdash.measurements.length;i<len;i++)$scope.cdash.measurements[i].dirty=!1;$scope.newMeasurement()},$scope.newMeasurement=function(){$scope.cdash.newmeasurement={id:-1,dirty:!1,name:"",summarypage:1,testpage:1}},$scope.save=function(){for(var measurements_to_save=[],i=0,len=$scope.cdash.measurements.length;i<len;i++)$scope.cdash.measurements[i].dirty&&measurements_to_save.push($scope.cdash.measurements[i]);""!=$scope.cdash.newmeasurement.name&&measurements_to_save.push($scope.cdash.newmeasurement);var parameters={projectid:$scope.cdash.projectid,measurements:measurements_to_save};$http.post("api/v1/manageMeasurements.php",parameters).then(function(s){$("#save_complete").show(),$("#save_complete").delay(3e3).fadeOut(400),s.data.id>0&&($scope.cdash.newmeasurement.id=s.data.id,$scope.cdash.measurements.push($scope.cdash.newmeasurement),$scope.newMeasurement())},function(e){$scope.cdash.error=e.data.error})},$scope.confirmDelete=function(measurement){modalSvc.showModal(measurement.id,$scope.removeMeasurement,"modal-template")},$scope.removeMeasurement=function(id_to_remove){var parameters={projectid:$scope.cdash.projectid,id:id_to_remove};$http({url:"api/v1/manageMeasurements.php",method:"DELETE",params:parameters}).then(function(){for(var i=0,len=$scope.cdash.measurements.length;i<len;i++)if($scope.cdash.measurements[i].id===id_to_remove){$scope.cdash.measurements.splice(i,1);break}})}});
CDash.controller("ManageOverviewController",function($scope,$http,apiLoader){apiLoader.loadPageData($scope,"api/v1/manageOverview.php"),$scope.finishSetup=function(){$scope.buildSortable={stop:function(e,ui){for(var index in $scope.cdash.buildcolumns)$scope.cdash.buildcolumns[index].position=index}},$scope.staticSortable={stop:function(e,ui){for(var index in $scope.cdash.staticrows)$scope.cdash.staticrows[index].position=index}}},$scope.addBuildColumn=function(column){var index=$scope.cdash.availablegroups.indexOf(column);$scope.cdash.availablegroups.splice(index,1),$scope.cdash.buildcolumns.push(column)},$scope.removeBuildColumn=function(column){var index=$scope.cdash.buildcolumns.indexOf(column);$scope.cdash.buildcolumns.splice(index,1),$scope.cdash.availablegroups.push(column)},$scope.addStaticRow=function(row){var index=$scope.cdash.availablegroups.indexOf(row);$scope.cdash.availablegroups.splice(index,1),$scope.cdash.staticrows.push(row)},$scope.removeStaticRow=function(row){var index=$scope.cdash.staticrows.indexOf(row);$scope.cdash.staticrows.splice(index,1),$scope.cdash.availablegroups.push(row)},$scope.saveLayout=function(){var buildElements=getSortedElements("#buildSortable");for(i=0;i<buildElements.length;++i)buildElements[i].type="build";var staticElements=getSortedElements("#staticSortable");for(i=0;i<staticElements.length;++i)staticElements[i].type="static";var newLayout=JSON.stringify(buildElements.concat(staticElements));$("#loading").attr("src","img/loading.gif");var parameters={projectid:$scope.cdash.projectid,saveLayout:newLayout};$http.post("api/v1/manageOverview.php",parameters).then(function(){$("#loading").attr("src","img/check.gif")})}});
CDash.filter("filter_subproject_groups",function(){return function(input,group){if("undefined"==typeof group||null===group)return input;group_id=Number(group.id);var output=[];for(var key in input)Number(input[key].group)===group_id&&output.push(input[key]);return output}}).controller("ManageSubProjectController",function($scope,$http,apiLoader){apiLoader.loadPageData($scope,"api/v1/manageSubProject.php"),$scope.finishSetup=function(){$scope.cdash.groups&&$scope.cdash.groups.sort(function(a,b){return Number(a.position)-Number(b.position)}),$scope.sortable={stop:function(e,ui){for(var index in $scope.cdash.groups)$scope.cdash.groups[index].position=index}}},$scope.createSubProject=function(newSubProject,groupName){var parameters={projectid:$scope.cdash.projectid,newsubproject:newSubProject,group:groupName};$http.post("api/v1/subproject.php",parameters).then(function(s){var subproj=s.data;subproj.error?$scope.cdash.error=subproj.error:($("#subproject_created").show(),$("#subproject_created").delay(3e3).fadeOut(400),$scope.cdash.subprojects.push(subproj))})},$scope.createGroup=function(newGroup,threshold,isDefault){var parameters={projectid:$scope.cdash.projectid,newgroup:newGroup,threshold:threshold,isdefault:isDefault};$http.post("api/v1/subproject.php",parameters).then(function(s){var group=s.data;group.is_default&&($scope.cdash.default_group_id=group.id),$scope.cdash.groups.push(group)})},$scope.updateGroup=function(group,is_default){var parameters={projectid:$scope.cdash.projectid,groupid:group.id,name:group.name,threshold:group.coverage_threshold,is_default:is_default};$http({url:"api/v1/subproject.php",method:"PUT",params:parameters}).then(function(s){s.data.error?$scope.cdash.error=s.data.error:($("#group_updated_"+group.id).show(),$("#group_updated_"+group.id).delay(3e3).fadeOut(400))})},$scope.deleteGroup=function(groupId){var parameters={projectid:$scope.cdash.projectid,groupid:groupId};$http({url:"api/v1/subproject.php",method:"DELETE",params:parameters}).then(function(){for(var index=-1,i=0,len=$scope.cdash.groups.length;i<len;i++)if($scope.cdash.groups[i].id===groupId){index=i;break}index>-1&&$scope.cdash.groups.splice(index,1)})},$scope.updateGroupOrder=function(){var newLayout=getSortedElements("#sortable"),parameters={projectid:$scope.cdash.projectid,newLayout:newLayout};$http.post("api/v1/subproject.php",parameters).then(function(s){s.data.error?$scope.cdash.error=s.data.error:($("#order_updated").show(),$("#order_updated").delay(3e3).fadeOut(400))})}});
CDash.controller("OverviewController",function($scope,$location,anchors,apiLoader){apiLoader.loadPageData($scope,"api/v1/overview.php"),$scope.finishSetup=function(){$scope.jumpToAnchor=anchors.jumpToAnchor,""!=$location.hash()&&anchors.jumpToAnchor($location.hash())}}),CDash.directive("linechart",function(){return{restrict:"E",replace:!0,scope:{data:"=data",groupname:"=groupname",measurementname:"=measurementname",project:"=project",anchor:"=anchor",sort:"=sort"},template:'<div class="overview-line-chart"/>',link:function(scope,element,attrs){if(scope.groupname){var data=JSON.parse(scope.data);data.length>0&&(element[0].id=scope.groupname+"_"+scope.measurementname+"_chart",makeLineChart(element[0].id,data,scope.project,scope.anchor,scope.sort))}}}}),CDash.directive("bulletchart",function(){return{restrict:"E",replace:!0,scope:{data:"=data",categoryname:"=categoryname"},template:'<div class="overview-bullet-chart"><svg></svg></div>',link:function(scope,element,attrs){if(scope.data){element[0].id=scope.data.name_clean+"_"+scope.categoryname+"_bullet";var chart_name=(JSON.parse(scope.data.chart),scope.group_name+" "+scope.data.name),element_name="#"+element[0].id+" svg";makeBulletChart(chart_name,element_name,scope.data.low,scope.data.medium,scope.data.satisfactory,scope.data.current,scope.data.previous,25)}}}});
CDash.controller("QueryTestsController",function($scope,$rootScope,$filter,apiLoader,filters,multisort){$scope.loading=!0,$scope.pagination=[],$scope.pagination.filteredBuilds=[],$scope.pagination.currentPage=1,$scope.pagination.maxSize=5;var num_per_page_cookie=$.cookie("queryTests_num_per_page");num_per_page_cookie?$scope.pagination.numPerPage=parseInt(num_per_page_cookie):$scope.pagination.numPerPage=25,$scope.showfilters=!1,$rootScope.queryString.filterstring=filters.getString();var sort_order=[],sort_cookie_value=$.cookie("cdash_query_tests_sort");sort_cookie_value&&(sort_order=sort_cookie_value.split(",")),$scope.orderByFields=sort_order,apiLoader.loadPageData($scope,"api/v1/queryTests.php"),$scope.finishSetup=function(){$scope.cdash.showmatchingoutput=!1,$scope.cdash.extrafilterurl=filters.getLabelString($scope.cdash.filterdata),$scope.cdash.builds=$filter("orderBy")($scope.cdash.builds,$scope.orderByFields),$scope.pageChanged()},$scope.showfilters_toggle=function(){$scope.showfilters=!$scope.showfilters,filters.toggle($scope.showfilters)},$scope.pageChanged=function(){var begin=($scope.pagination.currentPage-1)*$scope.pagination.numPerPage,end=begin+$scope.pagination.numPerPage;end>0?$scope.pagination.filteredBuilds=$scope.cdash.builds.slice(begin,end):$scope.pagination.filteredBuilds=$scope.cdash.builds},$scope.updateOrderByFields=function(field,$event){multisort.updateOrderByFields($scope,field,$event),$scope.cdash.builds=$filter("orderBy")($scope.cdash.builds,$scope.orderByFields),$scope.pageChanged(),$.cookie("cdash_query_tests_sort",$scope.orderByFields)},$scope.numTestsPerPageChanged=function(){$.cookie("queryTests_num_per_page",$scope.pagination.numPerPage,{expires:365}),$scope.pageChanged()},$scope.toggleShowMatchingOutput=function(){$scope.cdash.showmatchingoutput=!$scope.cdash.showmatchingoutput}});
CDash.controller("SubProjectController",function($scope,$rootScope,$http){$scope.dataLoaded=!1,$scope.loadData=function(id){$scope.dataLoaded||($rootScope.queryString.subprojectid=id,$http({url:"api/v1/subproject.php",method:"GET",params:$rootScope.queryString}).then(function(s){$scope.details=s.data;for(var i=0,len=$scope.cdash.groups.length;i<len;i++)if($scope.cdash.groups[i].id===$scope.details.group){$scope.details.group=$scope.cdash.groups[i];break}$scope.dataLoaded=!0}))},$scope.deleteSubProject=function(id){var parameters={projectid:$scope.details.projectid,subprojectid:id};$http({url:"api/v1/subproject.php",method:"DELETE",params:parameters}).then(function(){for(var index=-1,i=0,len=$scope.cdash.subprojects.length;i<len;i++)if($scope.cdash.subprojects[i].id===id){index=i;break}index>-1&&$scope.cdash.subprojects.splice(index,1)})},$scope.addDependency=function(dependency,subprojectId){var parameters={projectid:$scope.details.projectid,subprojectid:subprojectId,dependencyid:dependency.id};$http({url:"api/v1/subproject.php",method:"PUT",params:parameters}).then(function(){for(var index=-1,i=0,len=$scope.details.available_dependencies.length;i<len;i++)if($scope.details.available_dependencies[i].id===dependency.id){index=i;break}if(index>-1){var added=$scope.details.available_dependencies.splice(index,1);$scope.details.dependencies.push(added[0])}})},$scope.removeDependency=function(dependencyId,subprojectId){var parameters={projectid:$scope.details.projectid,subprojectid:subprojectId,dependencyid:dependencyId};$http({url:"api/v1/subproject.php",method:"DELETE",params:parameters}).then(function(){for(var index=-1,i=0,len=$scope.details.dependencies.length;i<len;i++)if($scope.details.dependencies[i].id===dependencyId){index=i;break}if(index>-1){var removed=$scope.details.dependencies.splice(index,1);$scope.details.available_dependencies.push(removed[0])}})},$scope.changeGroup=function(){var parameters={projectid:$scope.details.projectid,subprojectid:$scope.details.subprojectid,groupname:$scope.details.group.name};$http({url:"api/v1/subproject.php",method:"PUT",params:parameters}).then(function(){$("#group_changed_"+$scope.details.subprojectid).show(),$("#group_changed_"+$scope.details.subprojectid).delay(3e3).fadeOut(400)})}});
CDash.controller("TestDetailsController",function($scope,$http,$window,apiLoader){apiLoader.loadPageData($scope,"api/v1/testDetails.php"),$scope.finishSetup=function(){$scope.cdash.showgraph=!1,$scope.cdash.showcommandline=!1,$scope.cdash.rawdatalink="",$scope.queryString.graph&&($scope.cdash.graphSelection=$scope.queryString.graph,$scope.display_graph())},$scope.toggle_commandline=function(){$scope.cdash.showcommandline=!$scope.cdash.showcommandline},$scope.display_graph=function(){var testid=$scope.cdash.test.id,buildid=$scope.cdash.test.buildid,measurementname=$scope.cdash.graphSelection;if(""===$scope.cdash.graphSelection)return $scope.cdash.showgraph=!1,void $("#graph_options").html("");$scope.cdash.showgraph=!0;var query_params={testid:testid,buildid:buildid},graph_type="";switch($scope.cdash.rawdatalink="api/v1/testGraph.php?testid="+testid+"&buildid="+buildid,$scope.cdash.graphSelection){case"status":graph_type="status";break;case"time":graph_type="time";break;default:graph_type="measurement",query_params.measurementname=measurementname,$scope.cdash.rawdatalink+="&measurementname="+measurementname}$scope.cdash.rawdatalink+="&type="+graph_type,query_params.type=graph_type,$http({url:"api/v1/testGraph.php",method:"GET",params:query_params}).then(function(s){$scope.test_graph(s.data,graph_type)})},$scope.test_graph=function(response,graph_type){for(var buildids={},testids={},chart_data=[],i=0;i<response.length;i++){var series={};series.label=response[i].label,series.data=[];for(var j=0;j<response[i].data.length;j++)series.data.push([response[i].data[j].x,response[i].data[j].y]),0==i&&(buildids[response[i].data[j].x]=response[i].data[j].buildid,testids[response[i].data[j].x]=response[i].data[j].testid);chart_data.push(series)}var options={grid:{backgroundColor:"#fffaff",clickable:!0,hoverable:!0,hoverFill:"#444",hoverRadius:4},pan:{interactive:!0},zoom:{interactive:!0,amount:1.1},xaxis:{mode:"time"},yaxis:{zoomRange:!1,panRange:!1}};switch(graph_type){case"status":chart_data[0].points={symbol:"circle"},chart_data[1].points={symbol:"cross"},options.series={points:{show:!0,radius:5}},options.yaxis.ticks=[[-1,"Failed"],[1,"Passed"]],options.yaxis.min=-1.2,options.yaxis.max=1.2,options.colors=["#8aba5a","#de6868"];break;case"time":chart_data[1].lines={fill:!0};case"measurement":options.lines={show:!0},options.points={show:!0},options.colors=["#0000FF","#dba255","#919733"]}$("#graph_holder").bind("plotclick",function(e,pos,item){if(item){plot.highlight(item.series,item.datapoint),buildid=buildids[item.datapoint[0]],testid=testids[item.datapoint[0]];var url="testDetails.php?test="+testid+"&build="+buildid+"&graph="+$scope.cdash.graphSelection;$window.open(url)}}),plot=$.plot($("#graph_holder"),chart_data,options),date_formatter=d3.time.format("%b %d, %I:%M:%S %p"),$("#graph_holder").bind("plothover",function(event,pos,item){if(item){var x=date_formatter(new Date(item.datapoint[0])),y=item.datapoint[1].toFixed(2);$("#tooltip").html("<b>"+x+"</b><br/>"+item.series.label+": <b>"+y+"</b>").css({top:item.pageY+5,left:item.pageX+5}).fadeIn(200)}else $("#tooltip").hide()})},$scope.setup_compare=function(){$(".je_compare").je_compare({caption:!0})}});
CDash.controller("TestOverviewController",function($scope,$rootScope,$filter,apiLoader,filters,multisort){$scope.groupChanged=!1,$scope.showfilters=!1,$rootScope.queryString.filterstring=filters.getString();var sort_order=[];if("sort"in $rootScope.queryString)sort_order=$rootScope.queryString.sort.split(",");else{var sort_cookie_value=$.cookie("cdash_test_overview_sort");sort_order=sort_cookie_value?sort_cookie_value.split(","):["-failpercent"]}$scope.orderByFields=sort_order,$scope.pagination=[],$scope.pagination.filteredTests=[],$scope.pagination.currentPage=1,$scope.pagination.maxSize=5;var num_per_page_cookie=$.cookie("testOverview_num_per_page");num_per_page_cookie?$scope.pagination.numPerPage=parseInt(num_per_page_cookie):$scope.pagination.numPerPage=10,apiLoader.loadPageData($scope,"api/v1/testOverview.php"),$scope.finishSetup=function(){$scope.cdash.showpassedinitialvalue=$scope.cdash.showpassed,$scope.cdash.tests=$filter("orderBy")($scope.cdash.tests,$scope.orderByFields),$scope.pageChanged();var idx=$scope.cdash.groups.map(function(x){return x.id}).indexOf($scope.cdash.groupid);idx<0&&(idx=0),$scope.cdash.selectedGroup=$scope.cdash.groups[idx]},$scope.pageChanged=function(){var begin=($scope.pagination.currentPage-1)*$scope.pagination.numPerPage,end=begin+$scope.pagination.numPerPage;end>0?$scope.pagination.filteredTests=$scope.cdash.tests.slice(begin,end):$scope.pagination.filteredTests=$scope.cdash.tests},$scope.numTestsPerPageChanged=function(){$.cookie("testOverview_num_per_page",$scope.pagination.numPerPage,{expires:365}),$scope.pageChanged()},$scope.showfilters_toggle=function(){$scope.showfilters=!$scope.showfilters,filters.toggle($scope.showfilters)},$scope.updateOrderByFields=function(field,$event){multisort.updateOrderByFields($scope,field,$event),$scope.cdash.tests=$filter("orderBy")($scope.cdash.tests,$scope.orderByFields),$scope.pageChanged(),$.cookie("cdash_test_overview_sort",$scope.orderByFields)},$scope.updateSelection=function(){var uri="//"+location.host+location.pathname+"?project="+$scope.cdash.projectname_encoded;uri+=$scope.cdash.begin_date==$scope.cdash.end_date?"&date="+$scope.cdash.begin_date:"&begin="+$scope.cdash.begin_date+"&end="+$scope.cdash.end_date,$scope.cdash.selectedGroup.id>0&&(uri+="&group="+$scope.cdash.selectedGroup.id),1==$scope.cdash.showpassed&&(uri+="&showpassed=1"),uri+=filters.getString(),window.location=uri}});
CDash.controller("TestSummaryController",function($scope,apiLoader,multisort){$scope.showfilters=!1,$scope.showgraph=!1,$scope.graphurl="";var sort_order=[],sort_cookie_value=$.cookie("cdash_test_summary_sort");sort_order=sort_cookie_value?sort_cookie_value.split(","):["status","site"],$scope.orderByFields=sort_order,apiLoader.loadPageData($scope,"api/v1/testSummary.php"),$scope.finishSetup=function(){$scope.graphurl=$scope.failureGraphUrl()},$scope.updateOrderByFields=function(field,$event){multisort.updateOrderByFields($scope,field,$event),$.cookie("cdash_test_summary_sort",$scope.orderByFields)},$scope.failureGraphUrl=function(){return"ajax/showtestfailuregraph.php?testname="+$scope.cdash.testName+"&projectid="+$scope.cdash.projectid+"&starttime="+$scope.cdash.currentstarttime},$scope.resetZoom=function(){$scope.graphurl.indexOf("zoomout")!=-1?$scope.graphurl=$scope.failureGraphUrl():$scope.graphurl=$scope.failureGraphUrl()+"&zoomout=1"}});
CDash.controller("UserController",function($scope,$http,$timeout,apiLoader){apiLoader.loadPageData($scope,"api/v1/user.php"),$scope.deleteSchedule=function(job){if(window.confirm("Are you sure you want to delete this schedule?")){var parameters={removeschedule:job.id};$http({url:"manageClient.php",method:"GET",params:parameters}).then(function(){for(var index=-1,i=0,len=$scope.cdash.jobschedule.length;i<len;i++)if($scope.cdash.jobschedule[i].id===job.id){index=i;break}index>-1&&$scope.cdash.jobschedule.splice(index,1)},function(e){$scope.cdash.message=e.data.error})}},$scope.generateToken=function(){var parameters={description:$scope.cdash.tokendescription};$http.post("api/v1/authtoken.php",parameters).then(function(s){var authtoken=s.data.token;authtoken.copied=!1,$scope.cdash.authtokens.push(authtoken)},function(e){$scope.cdash.message=e.data.error})},$scope.copyTokenSuccess=function(token){token.copied=!0,token.showcheck=!0,$timeout(function(){token.showcheck=!1},2e3)},$scope.revokeToken=function(authtoken){var parameters={hash:authtoken.hash};$http({url:"api/v1/authtoken.php",method:"DELETE",params:parameters}).then(function(){for(var index=-1,i=0,len=$scope.cdash.authtokens.length;i<len;i++)if($scope.cdash.authtokens[i].hash===authtoken.hash){index=i;break}index>-1&&$scope.cdash.authtokens.splice(index,1)},function(e){$scope.cdash.message=e.data.error})}});
CDash.controller("UserStatisticsController",function($scope,$filter,apiLoader,multisort){var sort_order=[],sort_cookie_value=$.cookie("cdash_user_stats_sort");sort_order=sort_cookie_value?sort_cookie_value.split(","):["-totalupdatedfiles","-fixed_errors","-fixed_warnings","-fixed_tests","failed_errors","failed_warnings","failed_tests"],$scope.orderByFields=sort_order,apiLoader.loadPageData($scope,"api/v1/userStatistics.php"),$scope.finishSetup=function(){$scope.cdash.users=$filter("orderBy")($scope.cdash.users,$scope.orderByFields)},$scope.defaultSorting=function(){$scope.orderByFields=["-totalupdatedfiles","-fixed_errors","-fixed_warnings","-fixed_tests","failed_errors","failed_warnings","failed_tests"],$scope.cdash.users=$filter("orderBy")($scope.cdash.users,$scope.orderByFields),$.cookie("cdash_user_stats_sort",null)},$scope.updateOrderByFields=function(field,$event){multisort.updateOrderByFields($scope,field,$event),$scope.cdash.users=$filter("orderBy")($scope.cdash.users,$scope.orderByFields),$.cookie("cdash_user_stats_sort",$scope.orderByFields)}});
CDash.controller("ViewBuildErrorController",function($scope,$sce,apiLoader){$scope.loading=!0,$scope.pagination=[],$scope.pagination.buildErrors=[],$scope.pagination.currentPage=1,$scope.pagination.numPerPage=25,$scope.pagination.maxSize=5,apiLoader.loadPageData($scope,"api/v1/viewBuildError.php"),$scope.finishSetup=function(){$scope.setPage(1)},$scope.setPage=function(pageNo){var begin=(pageNo-1)*$scope.pagination.numPerPage,end=begin+$scope.pagination.numPerPage;end>0?$scope.pagination.buildErrors=$scope.cdash.errors.slice(begin,end):$scope.pagination.buildErrors=$scope.cdash.errors},$scope.pageChanged=function(){$scope.setPage($scope.pagination.currentPage)}}).directive("buildError",function(VERSION){return{templateUrl:"build/views/partials/buildError_"+VERSION+".html"}});
CDash.controller("ViewConfigureController",function($scope,apiLoader){apiLoader.loadPageData($scope,"api/v1/viewConfigure.php")});
CDash.controller("ViewDynamicAnalysisController",function($scope,apiLoader){apiLoader.loadPageData($scope,"api/v1/viewDynamicAnalysis.php")});
CDash.controller("ViewDynamicAnalysisFileController",function($scope,apiLoader){apiLoader.loadPageData($scope,"api/v1/viewDynamicAnalysisFile.php")});
function ViewNotesController($scope,$location,anchors,apiLoader){apiLoader.loadPageData($scope,"api/v1/viewNotes.php"),$scope.finishSetup=function(){""!=$location.hash()&&anchors.jumpToAnchor($location.hash())},$scope.gotoNote=function(x){var newHash="note"+x;anchors.jumpToAnchor(newHash)}}CDash.controller("ViewNotesController",["$scope","$location","anchors","apiLoader",ViewNotesController]);
CDash.controller("ViewProjectsController",function($scope,apiLoader){$scope.showfilters=!1,apiLoader.loadPageData($scope,"api/v1/viewProjects.php")});
CDash.controller("ViewSubProjectsController",function($scope,multisort,apiLoader){$scope.showfilters=!1;var sort_order=[],sort_cookie_value=$.cookie("cdash_subproject_sort");sort_cookie_value&&(sort_order=sort_cookie_value.split(",")),$scope.sortSubProjects={orderByFields:sort_order},apiLoader.loadPageData($scope,"api/v1/viewSubProjects.php"),$scope.updateOrderByFields=function(obj,field,$event){multisort.updateOrderByFields(obj,field,$event),$.cookie("cdash_subproject_sort",obj.orderByFields)}});
CDash.controller("ViewTestController",function($scope,$rootScope,$http,$filter,$q,apiLoader,multisort,filters){$scope.loading=!0,$scope.pagination=[],$scope.pagination.filteredTests=[],$scope.pagination.currentPage=1,$scope.pagination.maxSize=5;var num_per_page_cookie=$.cookie("viewTest_num_per_page");num_per_page_cookie?$scope.pagination.numPerPage=parseInt(num_per_page_cookie):$scope.pagination.numPerPage=25,$scope.showfilters=!1,$rootScope.queryString.filterstring=filters.getString();var sort_order=[],sort_cookie_value=$.cookie("cdash_view_test_sort");sort_order=sort_cookie_value?sort_cookie_value.split(","):["subprojectname","status","name"],$scope.orderByFields=sort_order,$scope.canceler=$q.defer(),apiLoader.loadPageData($scope,"api/v1/viewTest.php"),$scope.finishSetup=function(){$scope.cdash.extrafilterurl=filters.getLabelString($scope.cdash.filterdata),$scope.cdash.tests=$filter("orderBy")($scope.cdash.tests,$scope.orderByFields),$scope.setPage(1)},$scope.showfilters_toggle=function(){$scope.showfilters=!$scope.showfilters,filters.toggle($scope.showfilters)},$scope.setPage=function(pageNo){var begin=(pageNo-1)*$scope.pagination.numPerPage,end=begin+$scope.pagination.numPerPage;end>0?$scope.pagination.filteredTests=$scope.cdash.tests.slice(begin,end):$scope.pagination.filteredTests=$scope.cdash.tests;for(var tests_to_load=[],i=0,len=$scope.pagination.filteredTests.length;i<len;i++)"detailsloaded"in $scope.pagination.filteredTests[i]||tests_to_load.push($scope.pagination.filteredTests[i].name);tests_to_load.length>0&&$http({url:"api/v1/viewTest.php",method:"GET",params:{"tests[]":tests_to_load,previous_builds:$scope.cdash.previous_builds,time_begin:$scope.cdash.time_begin,time_end:$scope.cdash.time_end,projectid:$scope.cdash.projectid,groupid:$scope.cdash.groupid},timeout:$scope.canceler.promise}).then(function(s){function copy_test_details(test,response){"Missing"!==test.status&&("history"in response&&(test.history=response.history,test.historyclass=response.historyclass),"summary"in response&&(test.summary=response.summary,test.summaryclass=response.summaryclass),test.detailsloaded=!0)}var response=s.data;$scope.cdash.displayhistory=$scope.cdash.displayhistory||response.displayhistory,$scope.cdash.displaysummary=$scope.cdash.displaysummary||response.displaysummary;for(var i=0,len1=response.tests.length;i<len1;i++)for(var j=0,len2=$scope.pagination.filteredTests.length;j<len2;j++)response.tests[i].name===$scope.pagination.filteredTests[j].name&&copy_test_details($scope.pagination.filteredTests[j],response.tests[i]);for(var i=0,len1=response.tests.length;i<len1;i++)for(var j=0,len2=$scope.cdash.tests.length;j<len2;j++)response.tests[i].name===$scope.cdash.tests[j].name&&copy_test_details($scope.cdash.tests[j],response.tests[i])})},$scope.pageChanged=function(){$scope.setPage($scope.pagination.currentPage)},$scope.updateOrderByFields=function(field,$event){multisort.updateOrderByFields($scope,field,$event),$scope.cdash.tests=$filter("orderBy")($scope.cdash.tests,$scope.orderByFields),$scope.pageChanged(),$.cookie("cdash_view_test_sort",$scope.orderByFields)},$scope.sortByExtraMeasurement=function(idx,$event){var field="measurements["+idx+"]";$scope.updateOrderByFields(field,$event)},$scope.numTestsPerPageChanged=function(){$.cookie("viewTest_num_per_page",$scope.pagination.numPerPage,{expires:365}),$scope.pageChanged()},$scope.cancelAjax=function(){$scope.canceler.resolve()}});
CDash.controller("ViewUpdateController",function($scope,$rootScope,$http,apiLoader){$scope.graphLoaded=!1,$scope.graphLoading=!1,$scope.showGraph=!1,apiLoader.loadPageData($scope,"api/v1/viewUpdate.php"),$scope.toggleGraph=function(){$scope.showGraph=!$scope.showGraph,$scope.graphLoaded||$scope.loadGraph()},$scope.loadGraph=function(){$scope.graphLoading=!0,$http({url:"api/v1/buildUpdateGraph.php",method:"GET",params:{buildid:$scope.cdash.build.buildid}}).then(function(s){$scope.initializeGraph(s.data),$scope.graphLoaded=!0,$scope.graphLoading=!1})},$scope.initializeGraph=function(input){var options={lines:{show:!0},points:{show:!0},xaxis:{mode:"time"},grid:{backgroundColor:"#fffaff",clickable:!0,hoverable:!0,hoverFill:"#444",hoverRadius:4},selection:{mode:"x"},colors:["#0000FF","#dba255","#919733"]};$("#graph_holder").bind("selected",function(event,area){plot=$.plot($("#graph_holder"),[{label:"Number of changed files",data:input.data}],$.extend(!0,{},options,{xaxis:{min:area.x1,max:area.x2}}))}),$("#graph_holder").bind("plotclick",function(e,pos,item){item&&(plot.highlight(item.series,item.datapoint),buildid=input.buildids[item.datapoint[0]],window.location="buildSummary.php?buildid="+buildid)}),plot=$.plot($("#graph_holder"),[{label:"Number of changed files",data:input.data}],options)}}).directive("updatedFiles",function(VERSION){return{templateUrl:"build/views/partials/updatedfiles_"+VERSION+".html"}});
//# sourceMappingURL=1stparty.min.js.map
